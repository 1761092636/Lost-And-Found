<!DOCTYPE html>
<html class="wide wow-animation" lang="en">
  <head>
    <title>add</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css2?family=Red+Hat+Display:ital,wght@0,400;0,500;0,700;0,900;1,700&display=swap">
    <link rel="stylesheet" href="css/bootstrap.css">
    <link rel="stylesheet" href="css/fonts.css">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/checkout.css">
    <link rel="stylesheet" href="css/back.css">
  </head>
  <body>
    <div class="preloader">
      <div class="preloader-body">
        <div class="cssload-container">
          <div class="cssload-speeding-wheel"></div>
        </div>
      </div>
    </div>
    <div class="page">
      <header class="section page-header">
        <!--RD Navbar-->
        <div class="rd-navbar-wrap">
          <nav class="rd-navbar rd-navbar-classic" data-layout="rd-navbar-fixed" data-sm-layout="rd-navbar-fixed" data-md-layout="rd-navbar-fixed" data-lg-layout="rd-navbar-fixed" data-xl-layout="rd-navbar-static" data-xxl-layout="rd-navbar-static" data-md-device-layout="rd-navbar-fixed" data-lg-device-layout="rd-navbar-fixed" data-xl-device-layout="rd-navbar-static" data-xxl-device-layout="rd-navbar-static" data-xl-stick-up-offset="3px" data-xxl-stick-up-offset="3px" data-xl-stick-up="true" data-xxl-stick-up="true">
            <div class="rd-navbar-main-outer">
              <div class="rd-navbar-main">
                <div class="rd-navbar-main-col">
                  <!--RD Navbar Panel-->
                  <div class="rd-navbar-panel">
                    <!--RD Navbar Toggle-->
                    <button class="rd-navbar-toggle" data-rd-navbar-toggle=".rd-navbar-nav-wrap"><span></span></button>



                    <!--RD Navbar Brand-->
                    <div class="rd-navbar-brand">
                      <!--Brand--><a class="brand" href="index.html"><img class="brand-logo-dark" src="images/logo1.PNG" alt="" width="103" height="34" loading="lazy"/><img class="brand-logo-light" src="images/logo1.PNG" alt="" width="103" height="34" loading="lazy"/></a>
                    </div>
                  </div>
                </div>
                
               
                       <div class="rd-navbar-main-col">
                            <div class="rd-navbar-main-element">
                                <div class="rd-navbar-nav-wrap">
                                    <ul class="rd-navbar-nav">
                                        <li class="rd-nav-item"><a class="rd-nav-link" href="index.html">首页</a></li>
                                        <li class="rd-nav-item"><a class="rd-nav-link" href="#">招领中心</a>
                                            <ul class="rd-menu rd-navbar-dropdown">
                                                <li class="rd-dropdown-item "><a class="rd-dropdown-link"
                                                        href="lost.html">我是拾主</a></li>
                                                <li class="rd-dropdown-item"><a class="rd-dropdown-link"
                                                        href="found.html">我是失主</a></li>
                                            </ul>
                                        </li>
                                        <li class="rd-nav-item "><a class="rd-nav-link" href="track.html">安心溯源</a>
                                        </li>
                                        <li class="rd-nav-item"><a class="rd-nav-link" href="rank.html">排行榜</a>
                                        </li>
                                        <li class="rd-nav-item"><a class="rd-nav-link"
                                                href="history.html">操作记录</a>
                                            <ul class="rd-menu rd-navbar-dropdown">
                                                <li class="rd-dropdown-item "><a class="rd-dropdown-link"
                                                        href="history-my.html">我的操作记录</a></li>
                                                <li class="rd-dropdown-item"><a class="rd-dropdown-link"
                                                        href="history.html">操作记录公开</a>
                                                </li>
                                            </ul>
                                        </li>
                                        <li class="rd-nav-item"><a class="rd-nav-link" href="#">用户中心</a>
                                            <ul class="rd-menu rd-navbar-dropdown">
                                                <li class="rd-dropdown-item "><a class="rd-dropdown-link"
                                                        href="login.html">用户登陆</a></li>
                                                <li class="rd-dropdown-item"><a class="rd-dropdown-link"
                                                        href="register.html">用户注册</a></li>
                                                <li class="rd-dropdown-item"><a class="rd-dropdown-link"
                                                        href="LostItemAdd.html">上报个人失物</a></li>
                                                <li class="rd-dropdown-item"><a class="rd-dropdown-link"
                                                        href="mylost.html">我的失物管理</a></li>
                                                <li class="rd-dropdown-item"><a class="rd-dropdown-link"
                                                        href="application.html">我的失物申请</a></li>
                                            </ul>
                                        </li>
                                       
                                    </ul>
                                </div>
                            </div>
                        </div>
                
                <div class="rd-navbar-main-col">
                  <div class="rd-navbar-widgets rd-navbar-fixed-element">
                    
                    <div class="rd-navbar-search">
                   
                      <div class="rd-navbar-search-modal">
                        <form class="rd-search" action="search-results.html" data-search-live="rd-search-results-live" method="GET">
                          <div class="h2 rd-navbar-fixed--hidden">What are you looking for?</div>
                          <div class="form-wrap">
                            <label class="form-label" for="rd-navbar-search-form-input">Search this store</label>
                            <input class="rd-navbar-search-form-input form-input" id="rd-navbar-search-form-input" type="text" name="s" autocomplete="off">
                            <button class="rd-search-form-submit" type="submit">
                              <svg class="svg-fill" width="24" height="25" viewBox="0 0 24 25">
                                <path fill-rule="evenodd" clip-rule="evenodd" d="M10.961 17.9605C15.1811 17.9605 18.6022 14.476 18.6022 10.1776C18.6022 5.87924 15.1811 2.39473 10.961 2.39473C6.74094 2.39473 3.31988 5.87924 3.31988 10.1776C3.31988 14.476 6.74094 17.9605 10.961 17.9605ZM10.961 20.3552C16.4796 20.3552 20.9533 15.7985 20.9533 10.1776C20.9533 4.55666 16.4796 0 10.961 0C5.44245 0 0.96875 4.55666 0.96875 10.1776C0.96875 15.7985 5.44245 20.3552 10.961 20.3552Z"></path>
                                <path d="M16.0215 17.9692L17.875 16.2874L23.6543 22.8949C24.1103 23.4162 24.065 24.2153 23.5532 24.6797C23.0414 25.1442 22.2568 25.098 21.8008 24.5767L16.0215 17.9692Z"></path>
                              </svg>
                            </button>
                          </div>
                          <div class="rd-search-results-live" id="rd-search-results-live"></div>
                        </form>
                      </div>
                    </div>
                    <!--RD Navbar cart-->
                    <div class="rd-navbar-cart-wrap">
                      <button  id="user_now">
                        <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor" class="bi bi-person" viewBox="0 0 16 16">
                          <path d="M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0zm4 8c0 1-1 1-1 1H3s-1 0-1-1 1-4 6-4 6 3 6 4zm-1-.004c-.001-.246-.154-.986-.832-1.664C11.516 10.68 10.289 10 8 10c-2.29 0-3.516.68-4.168 1.332-.678.678-.83 1.418-.832 1.664h10z"/>
                        </svg>
                      </button>

                    </div>
                  </div>
                </div>
              </div>
            </div>
          </nav>
        </div>
      </header>
      <div class="kele" onclick="window.history.back();">返回</div>
      <section class="section section-md">
        <div class="container">
          <div class="row row-50">
            <div class="col-lg-8">
              <h2>上报个人失物</h2>
           
              <form class="rd-form rd-mailform" data-form-output="form-output-global" data-form-type="contact" method="post" action="">
                <div class="row row-30 align-items-end">
                  <div class="col-md-6">
                    <label class="form-label form-label-outside" for="lostItemName">失物名称</label>
                    <div class="form-wrap">
                      <input class="form-input" id="lostItemName" type="text" name="lostItemName" data-constraints="@Required" placeholder="名称">
                    </div>
                  </div>
                  
                  <div class="col-md-6">
                    <label class="form-label form-label-outside" for="lostDate">丢失日期</label>
                    <div class="form-wrap">
                      <input class="form-input" id="lostDate" type="datetime-local" name="lostDate" data-constraints="@Required" placeholder="丢失日期">
                    </div>
                  </div>
                  <div class="col-md-6">
                    <label class="form-label form-label-outside" for="lostimg">电话</label>
                    <div class="form-wrap">
                      <input class="form-input disabled" id="lostimg" type="file" name="lostimg" placeholder="请选择图像" >
                      <span class="default" id="phoneErr">选择对应失物的图像</span> 
                    </div>
                  </div>
                  <div class="col-md-6">
                    <label class="form-label form-label-outside" for="location">丢失地点</label>
                    <div class="form-wrap">
                      <input class="form-input" id="location" type="text" name="location" data-constraints="@Required" placeholder="丢失地点">
                    </div>
                  </div>
                  <div class="col-md-6">
                    <label class="form-label form-label-outside" for="itemCategory">丢失物品种类</label>
                    <div class="form-wrap">
                      <input class="form-input" id="itemCategory" type="text" name="itemCategory" data-constraints="@Required" placeholder="物品种类">
                    </div>
                  </div>
                  <div class="col-md-6">
                    <label class="form-label form-label-outside" for="reward">赏金</label>
                    <div class="form-wrap">
                      <input class="form-input" id="reward" type="number" name="reward" data-constraints="@Required" placeholder="Wei">
                    </div>
                  </div>
                  <div class="col-12">
                    <label class="form-label form-label-outside" for="description">详细描述</label>
                    <div class="form-wrap">
                      <textarea class="form-input" id="description" name="description" data-constraints="@Required" placeholder="具体说说"></textarea>
                    </div>
                  </div>

                  <div class="col-12">
                    <div class="form-button group-sm text-center text-lg-start">
                      <button class="btn btn-primary" id="add_bt" type="button">提交</button>
                    </div>
                  </div>
                </div>
              </form>
            </div>

            <div class="col-lg-4">
              <div class="ps-xl-50">
                <h2>联系人</h2>
                <div class="row row-30">
                  <div class="col-lg-12 col-sm-6">
                    <h3 class="mb-10">地址:</h3>
                    <div class="big"><a class="link-gray-800" href="#">江西南昌 <br> 江西软件职业技术大学</a></div>
                  </div>
                  <div class="col-lg-12 col-sm-6">
                    <h3 class="mb-10">Phones:</h3>
                    <div class="big"><a class="link-gray-800" href="">13037241970</a></div>
                    <div class="big mt-0"><a class="link-gray-800" href="">181708654190</a></div>
                  </div>
                  <div class="col-lg-12 col-sm-6">
                    <h3 class="mb-10">邮箱地址:</h3>
                    <div class="big"><a class="link-primary link-underline" href="">1761669403@qq.com</a></div>
                  </div>
                  <div class="col-lg-12 col-sm-6">
                    <h3 class="mb-10">营业时间</h3>
                    <div class="big text-gray-800">周一 - 周五: 7：00 - 22：00</div>
                    <div class="big mt-0 text-gray-800">周六 - 周天: 8：00 - 20：00</div>
                  </div>

                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
      

    </div>
    <div class="snackbars" id="form-output-global"></div>



  </body>
</html>
<script src="js/jquery-3.3.1.min.js"></script>

<script>
var userData;
function performAddLostItem() {
    // 创建一个 FormData 对象
    var formData = new FormData();

    // 添加文本数据
    formData.append("lostItemName", $("#lostItemName").val());
    formData.append("description", $("#description").val());
    
    // 将时间字符串转换为时间戳
   var mylostDate = new Date($("#lostDate").val()).toISOString();
    var timestamp = new Date(mylostDate).getTime();



    formData.append("lostDate", timestamp);

    formData.append("location", $("#location").val());
    formData.append("itemCategory", $("#itemCategory").val());
    formData.append("reward", parseInt($("#reward").val()));
        console.log(formData);
    // 检查 userData 是否已定义
    if (userData) {
        formData.append("myuser", userData.data[0].address);
    } else {
        console.error("用户数据尚未加载完成");
        return;
    }

    // 添加文件数据
    var fileInput = document.getElementById('lostimg');
    var file = fileInput.files[0];
    formData.append("lostimg", file);

    // 发送Ajax请求
    $.ajax({
        type: "POST",
        url: "http://127.0.0.1:9526/router/AddLostItem",
        xhrFields: {
            withCredentials: true
        },
        crossDomain: true,
        processData: false, // 不处理数据
        contentType: false, // 不设置 content-type
        data: formData,
        success: function(data) {
            if (data.code === 0) {
               alert("ok")
            }
            console.log(data.code);
        },
        error: function(xhr, status, error) {
            console.log(xhr.responseText);
            console.error("上传失败:", error);
            alert("上传失败：" + error);
        }
    });
}

$.ajax({
    "type": "GET",
    "url": "http://127.0.0.1:9526/router/GetUser",
    xhrFields: {
        withCredentials: true // 允许携带凭证
    },
    crossDomain: true, // 允许跨域请求
    "success": function(data) {
        userData = data;
       
    }
});

// 点击事件处理程序调用封装的第二个 AJAX 请求函数
$("#add_bt").click(function() {
    performAddLostItem();
});


</script>
<script src="js/mdialog.js"></script>
<script type="text/javascript" src="footer.js"></script>
<script src="js/checkout.js"></script>
<script src="js/core.min.js"></script>
<script src="js/script.js"></script>
<script src="js/user_now.js"></script>
